{"cells":[{"value":"### üóÇÔ∏è Schema Operations: `public`\n\n<div style=\"font-size: 12px; background-color: rgba(52, 152, 219, 0.1); border-left: 3px solid #3498db; padding: 6px 10px; margin-bottom: 15px; border-radius: 3px; color: var(--vscode-editor-foreground);\">\n    <strong>‚ÑπÔ∏è Note:</strong> This notebook contains operations for managing the schema. Execute the cells below to perform operations.\n</div>\n\n#### üìä Schema Information\n\n<table style=\"font-size: 11px; width: 100%; border-collapse: collapse;\">\n    <tr><th style=\"text-align: left; width: 30%;\">Property</th><th style=\"text-align: left;\">Value</th></tr>\n    <tr><td><strong>Owner</strong></td><td>pg_database_owner</td></tr>\n    <tr><td><strong>Total Size</strong></td><td>30 GB</td></tr>\n    <tr><td><strong>Objects</strong></td><td>27 tables, 145 views, 0 functions</td></tr>\n    <tr><td><strong>Privileges</strong></td><td>DELETE ON public TO postgres, INSERT ON public TO postgres, REFERENCES ON public TO postgres, SELECT ON public TO postgres, TRIGGER ON public TO postgres, TRUNCATE ON public TO postgres, UPDATE ON public TO postgres</td></tr>\n</table>","kind":"markdown","language":"markdown"},{"value":"##### üì¶ Schema Objects","kind":"markdown","language":"markdown"},{"value":"-- List all objects in schema with sizes\nSELECT \n    CASE c.relkind\n        WHEN 'r' THEN 'table'\n        WHEN 'v' THEN 'view'\n        WHEN 'm' THEN 'materialized view'\n        WHEN 'i' THEN 'index'\n        WHEN 'S' THEN 'sequence'\n        WHEN 's' THEN 'special'\n        WHEN 'f' THEN 'foreign table'\n        WHEN 'p' THEN 'partitioned table'\nEND as object_type,\n    c.relname as object_name,\n    pg_size_pretty(pg_total_relation_size(quote_ident('public') || '.' || quote_ident(c.relname))) as size,\n    CASE WHEN c.relkind = 'r' THEN\n        (SELECT reltuples:: bigint FROM pg_class WHERE oid = c.oid)\n    ELSE NULL END as estimated_row_count\nFROM pg_class c\nJOIN pg_namespace n ON n.oid = c.relnamespace\nWHERE n.nspname = 'public'\nAND c.relkind in ('r', 'v', 'm', 'S', 'f', 'p')\nORDER BY c.relkind, pg_total_relation_size(c.oid) DESC; ","kind":"sql","language":"sql"},{"value":"##### üîê Schema Privileges","kind":"markdown","language":"markdown"},{"value":"-- List schema privileges\nSELECT grantee, string_agg(privilege_type, ', ') as privileges\nFROM(\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.table_privileges\n    WHERE table_schema = 'public'\n    UNION\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.routine_privileges\n    WHERE routine_schema = 'public'\n    UNION\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.usage_privileges\n    WHERE object_schema = 'public'\n) p\nGROUP BY grantee\nORDER BY grantee; ","kind":"sql","language":"sql"},{"value":"##### üõ°Ô∏è Grant Privileges","kind":"markdown","language":"markdown"},{"value":"-- Grant privileges(modify as needed)\nGRANT USAGE ON SCHEMA public TO role_name;\nGRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO role_name;\nGRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA public TO role_name;\nGRANT SELECT, USAGE ON ALL SEQUENCES IN SCHEMA public TO role_name;\n\n--Set default privileges for future objects\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO role_name;\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT EXECUTE ON FUNCTIONS TO role_name;\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT SELECT, USAGE ON SEQUENCES TO role_name; ","kind":"sql","language":"sql"},{"value":"##### üßπ Maintenance","kind":"markdown","language":"markdown"},{"value":"-- Schema maintenance\n\n--First analyze all tables(can be run within DO block)\nDO $$\nDECLARE\n    t record;\nBEGIN\n    FOR t IN \n        SELECT tablename \n        FROM pg_tables \n        WHERE pg_tables.schemaname = 'public'\nLOOP\n        EXECUTE 'ANALYZE VERBOSE ' || quote_ident('public') || '.' || quote_ident(t.tablename);\n    END LOOP;\nEND $$;\n\n--Note: VACUUM commands must be run as separate statements\n--The following are example VACUUM commands for each table in the schema\nSELECT format('VACUUM ANALYZE %I.%I;', schemaname, tablename) as vacuum_command\nFROM pg_tables \nWHERE schemaname = 'public'\nORDER BY tablename;\n\n--To execute VACUUM on a specific table, uncomment and modify:\n--VACUUM ANALYZE public.table_name; ","kind":"sql","language":"sql"},{"value":"##### ‚ùå Drop Schema","kind":"markdown","language":"markdown"},{"value":"-- Drop schema(BE CAREFUL!)\nDROP SCHEMA public; --This will fail if schema is not empty\n\n--To force drop schema and all objects:\n--DROP SCHEMA public CASCADE; ","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1769708345477","databaseName":"praxiapp_system","host":"localhost","port":5432,"username":"postgres","password":"postgres","custom":{"cells":[{"value":"### üóÇÔ∏è Schema Operations: `public`\n\n<div style=\"font-size: 12px; background-color: rgba(52, 152, 219, 0.1); border-left: 3px solid #3498db; padding: 6px 10px; margin-bottom: 15px; border-radius: 3px; color: var(--vscode-editor-foreground);\">\n    <strong>‚ÑπÔ∏è Note:</strong> This notebook contains operations for managing the schema. Execute the cells below to perform operations.\n</div>\n\n#### üìä Schema Information\n\n<table style=\"font-size: 11px; width: 100%; border-collapse: collapse;\">\n    <tr><th style=\"text-align: left; width: 30%;\">Property</th><th style=\"text-align: left;\">Value</th></tr>\n    <tr><td><strong>Owner</strong></td><td>pg_database_owner</td></tr>\n    <tr><td><strong>Total Size</strong></td><td>30 GB</td></tr>\n    <tr><td><strong>Objects</strong></td><td>27 tables, 145 views, 0 functions</td></tr>\n    <tr><td><strong>Privileges</strong></td><td>DELETE ON public TO postgres, INSERT ON public TO postgres, REFERENCES ON public TO postgres, SELECT ON public TO postgres, TRIGGER ON public TO postgres, TRUNCATE ON public TO postgres, UPDATE ON public TO postgres</td></tr>\n</table>","kind":"markdown","language":"markdown"},{"value":"##### üì¶ Schema Objects","kind":"markdown","language":"markdown"},{"value":"-- List all objects in schema with sizes\nSELECT \n    CASE c.relkind\n        WHEN 'r' THEN 'table'\n        WHEN 'v' THEN 'view'\n        WHEN 'm' THEN 'materialized view'\n        WHEN 'i' THEN 'index'\n        WHEN 'S' THEN 'sequence'\n        WHEN 's' THEN 'special'\n        WHEN 'f' THEN 'foreign table'\n        WHEN 'p' THEN 'partitioned table'\nEND as object_type,\n    c.relname as object_name,\n    pg_size_pretty(pg_total_relation_size(quote_ident('public') || '.' || quote_ident(c.relname))) as size,\n    CASE WHEN c.relkind = 'r' THEN\n        (SELECT reltuples:: bigint FROM pg_class WHERE oid = c.oid)\n    ELSE NULL END as estimated_row_count\nFROM pg_class c\nJOIN pg_namespace n ON n.oid = c.relnamespace\nWHERE n.nspname = 'public'\nAND c.relkind in ('r', 'v', 'm', 'S', 'f', 'p')\nORDER BY c.relkind, pg_total_relation_size(c.oid) DESC; ","kind":"sql","language":"sql"},{"value":"##### üîê Schema Privileges","kind":"markdown","language":"markdown"},{"value":"-- List schema privileges\nSELECT grantee, string_agg(privilege_type, ', ') as privileges\nFROM(\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.table_privileges\n    WHERE table_schema = 'public'\n    UNION\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.routine_privileges\n    WHERE routine_schema = 'public'\n    UNION\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.usage_privileges\n    WHERE object_schema = 'public'\n) p\nGROUP BY grantee\nORDER BY grantee; ","kind":"sql","language":"sql"},{"value":"##### üõ°Ô∏è Grant Privileges","kind":"markdown","language":"markdown"},{"value":"-- Grant privileges(modify as needed)\nGRANT USAGE ON SCHEMA public TO role_name;\nGRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO role_name;\nGRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA public TO role_name;\nGRANT SELECT, USAGE ON ALL SEQUENCES IN SCHEMA public TO role_name;\n\n--Set default privileges for future objects\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO role_name;\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT EXECUTE ON FUNCTIONS TO role_name;\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT SELECT, USAGE ON SEQUENCES TO role_name; ","kind":"sql","language":"sql"},{"value":"##### üßπ Maintenance","kind":"markdown","language":"markdown"},{"value":"-- Schema maintenance\n\n--First analyze all tables(can be run within DO block)\nDO $$\nDECLARE\n    t record;\nBEGIN\n    FOR t IN \n        SELECT tablename \n        FROM pg_tables \n        WHERE pg_tables.schemaname = 'public'\nLOOP\n        EXECUTE 'ANALYZE VERBOSE ' || quote_ident('public') || '.' || quote_ident(t.tablename);\n    END LOOP;\nEND $$;\n\n--Note: VACUUM commands must be run as separate statements\n--The following are example VACUUM commands for each table in the schema\nSELECT format('VACUUM ANALYZE %I.%I;', schemaname, tablename) as vacuum_command\nFROM pg_tables \nWHERE schemaname = 'public'\nORDER BY tablename;\n\n--To execute VACUUM on a specific table, uncomment and modify:\n--VACUUM ANALYZE public.table_name; ","kind":"sql","language":"sql"},{"value":"##### ‚ùå Drop Schema","kind":"markdown","language":"markdown"},{"value":"-- Drop schema(BE CAREFUL!)\nDROP SCHEMA public; --This will fail if schema is not empty\n\n--To force drop schema and all objects:\n--DROP SCHEMA public CASCADE; ","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1769708345477","databaseName":"praxiapp_system","host":"localhost","port":5432,"username":"postgres","password":"postgres","custom":{"cells":[],"metadata":{"connectionId":"1769708345477","databaseName":"praxiapp_system","host":"localhost","port":5432,"username":"postgres","password":"postgres","custom":{"cells":[{"value":"### üóÇÔ∏è Schema Operations: `public`\n\n<div style=\"font-size: 12px; background-color: rgba(52, 152, 219, 0.1); border-left: 3px solid #3498db; padding: 6px 10px; margin-bottom: 15px; border-radius: 3px; color: var(--vscode-editor-foreground);\">\n    <strong>‚ÑπÔ∏è Note:</strong> This notebook contains operations for managing the schema. Execute the cells below to perform operations.\n</div>\n\n#### üìä Schema Information\n\n<table style=\"font-size: 11px; width: 100%; border-collapse: collapse;\">\n    <tr><th style=\"text-align: left; width: 30%;\">Property</th><th style=\"text-align: left;\">Value</th></tr>\n    <tr><td><strong>Owner</strong></td><td>pg_database_owner</td></tr>\n    <tr><td><strong>Total Size</strong></td><td>30 GB</td></tr>\n    <tr><td><strong>Objects</strong></td><td>27 tables, 145 views, 0 functions</td></tr>\n    <tr><td><strong>Privileges</strong></td><td>DELETE ON public TO postgres, INSERT ON public TO postgres, REFERENCES ON public TO postgres, SELECT ON public TO postgres, TRIGGER ON public TO postgres, TRUNCATE ON public TO postgres, UPDATE ON public TO postgres</td></tr>\n</table>","kind":"markdown","language":"markdown"},{"value":"##### üì¶ Schema Objects","kind":"markdown","language":"markdown"},{"value":"-- List all objects in schema with sizes\nSELECT \n    CASE c.relkind\n        WHEN 'r' THEN 'table'\n        WHEN 'v' THEN 'view'\n        WHEN 'm' THEN 'materialized view'\n        WHEN 'i' THEN 'index'\n        WHEN 'S' THEN 'sequence'\n        WHEN 's' THEN 'special'\n        WHEN 'f' THEN 'foreign table'\n        WHEN 'p' THEN 'partitioned table'\nEND as object_type,\n    c.relname as object_name,\n    pg_size_pretty(pg_total_relation_size(quote_ident('public') || '.' || quote_ident(c.relname))) as size,\n    CASE WHEN c.relkind = 'r' THEN\n        (SELECT reltuples:: bigint FROM pg_class WHERE oid = c.oid)\n    ELSE NULL END as estimated_row_count\nFROM pg_class c\nJOIN pg_namespace n ON n.oid = c.relnamespace\nWHERE n.nspname = 'public'\nAND c.relkind in ('r', 'v', 'm', 'S', 'f', 'p')\nORDER BY c.relkind, pg_total_relation_size(c.oid) DESC; ","kind":"sql","language":"sql"},{"value":"##### üîê Schema Privileges","kind":"markdown","language":"markdown"},{"value":"-- List schema privileges\nSELECT grantee, string_agg(privilege_type, ', ') as privileges\nFROM(\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.table_privileges\n    WHERE table_schema = 'public'\n    UNION\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.routine_privileges\n    WHERE routine_schema = 'public'\n    UNION\n    SELECT DISTINCT grantee, privilege_type\n    FROM information_schema.usage_privileges\n    WHERE object_schema = 'public'\n) p\nGROUP BY grantee\nORDER BY grantee; ","kind":"sql","language":"sql"},{"value":"##### üõ°Ô∏è Grant Privileges","kind":"markdown","language":"markdown"},{"value":"-- Grant privileges(modify as needed)\nGRANT USAGE ON SCHEMA public TO role_name;\nGRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO role_name;\nGRANT EXECUTE ON ALL FUNCTIONS IN SCHEMA public TO role_name;\nGRANT SELECT, USAGE ON ALL SEQUENCES IN SCHEMA public TO role_name;\n\n--Set default privileges for future objects\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO role_name;\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT EXECUTE ON FUNCTIONS TO role_name;\nALTER DEFAULT PRIVILEGES IN SCHEMA public\n    GRANT SELECT, USAGE ON SEQUENCES TO role_name; ","kind":"sql","language":"sql"},{"value":"##### üßπ Maintenance","kind":"markdown","language":"markdown"},{"value":"-- Schema maintenance\n\n--First analyze all tables(can be run within DO block)\nDO $$\nDECLARE\n    t record;\nBEGIN\n    FOR t IN \n        SELECT tablename \n        FROM pg_tables \n        WHERE pg_tables.schemaname = 'public'\nLOOP\n        EXECUTE 'ANALYZE VERBOSE ' || quote_ident('public') || '.' || quote_ident(t.tablename);\n    END LOOP;\nEND $$;\n\n--Note: VACUUM commands must be run as separate statements\n--The following are example VACUUM commands for each table in the schema\nSELECT format('VACUUM ANALYZE %I.%I;', schemaname, tablename) as vacuum_command\nFROM pg_tables \nWHERE schemaname = 'public'\nORDER BY tablename;\n\n--To execute VACUUM on a specific table, uncomment and modify:\n--VACUUM ANALYZE public.table_name; ","kind":"sql","language":"sql"},{"value":"##### ‚ùå Drop Schema","kind":"markdown","language":"markdown"},{"value":"-- Drop schema(BE CAREFUL!)\nDROP SCHEMA public; --This will fail if schema is not empty\n\n--To force drop schema and all objects:\n--DROP SCHEMA public CASCADE; ","kind":"sql","language":"sql"}],"metadata":{"connectionId":"1769708345477","databaseName":"praxiapp_system","host":"localhost","port":5432,"username":"postgres","password":"postgres","custom":{"cells":[],"metadata":{"connectionId":"1769708345477","databaseName":"praxiapp_system","host":"localhost","port":5432,"username":"postgres","password":"postgres","enableScripts":true}},"enableScripts":true}},"enableScripts":true}},"enableScripts":true}}}}